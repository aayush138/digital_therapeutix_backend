<!DOCTYPE html>
<html lang="en" class="bg-[#f3fdf2] min-h-screen">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Upload FASTA + Threshold</title>
  <link rel="icon" href="{{ url_for('static', filename='favicon.png') }}" type="image/x-icon">
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="flex items-center justify-center min-h-screen px-4 relative overflow-hidden">

  <!-- Background wave -->
  <div class="absolute inset-0 bg-no-repeat bg-cover opacity-30 z-0"
       style="background-image: url('{{ url_for('static', filename='your-wave-pattern.png') }}');">
  </div>

  <!-- Content card -->
  <div class="max-w-md w-full bg-white rounded-2xl shadow-lg p-8 text-center z-10">
    
    <!-- Logo -->
    <div class="mb-6 flex items-center justify-center">
      <img src="{{ url_for('static', filename='logo.png') }}" alt="DTPx Logo" class="h-12" />
    </div>

    <!-- Heading -->
    <h2 class="text-xl font-semibold text-gray-900 mb-2">Upload FASTA + Threshold</h2>
    <p class="text-gray-600 text-sm mb-6">
      Upload your DNA FASTA file and set the threshold value
    </p>

  <!-- Upload Form -->
  <form method="POST" enctype="multipart/form-data" class="space-y-6 text-left relative" id="uploadForm">
    
    <!-- FASTA File Upload -->
    <div>
      <label for="fasta_file" class="block text-sm font-medium text-gray-700 mb-2">
        <span class="inline-flex items-center gap-1">
          DNA FASTA File <span class="text-red-500">*</span>
        </span>
      </label>

      <!-- Hidden actual input -->
      <input type="file" id="fasta_file" name="fasta_file" required accept=".fasta,.fa"
            class="sr-only" onchange="updateFileName()" />

      <!-- Styled label as button -->
      <label for="fasta_file"
            class="block w-full cursor-pointer bg-[#f58c36] hover:bg-[#f58c80] text-black font-normal text-sm px-4 py-2 rounded-md text-center transition">
        Choose FASTA File
      </label>

      <!-- File name preview -->
      <p id="file_name_preview" class="mt-2 text-sm text-gray-600 truncate">No file selected</p>
    </div>

    <!-- Threshold Field -->
    <div>
      <label for="threshold" class="block text-sm font-medium text-gray-700 mb-1">
        <span class="inline-flex items-center gap-1">
          Probability Threshold (e.g. 50.2)
        </span>
      </label>
      <input type="number" step="0.1" name="threshold" id="threshold" value="50" required
            class="w-full border border-gray-300 rounded-md p-2 text-sm bg-white shadow-sm focus:ring-[#C3DA2C] focus:border-[#C3DA2C]" />
    </div>

    <!-- Submit Button -->
    <button type="submit"
            class="w-full mt-4 bg-[#2e7d32] hover:bg-[#256829] text-white font-semibold py-3 px-4 rounded-md transition flex items-center justify-center gap-2"
            id="submitBtn">
      <svg id="spinner" class="w-4 h-4 animate-spin hidden" fill="none" viewBox="0 0 24 24">
        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
        <path class="opacity-75" fill="currentColor"
              d="M4 12a8 8 0 018-8v8H4z"></path>
      </svg>
      <span>Submit</span>
    </button>
  </form>

    <!-- Footer -->
    <div class="mt-6 text-xs text-gray-500 text-center">
      © 2025 Digital Theuruphatics. All rights reserved.<br>
      <a href="#" class="underline hover:text-gray-800">Terms & Conditions</a> ·
      <a href="#" class="underline hover:text-gray-800">Privacy Policy</a>
    </div>
  </div>

  <!-- Script for file name preview + submit spinner -->
  <script>
    function updateFileName() {
      const input = document.getElementById('fasta_file');
      const preview = document.getElementById('file_name_preview');
      preview.textContent = input.files.length > 0 ? input.files[0].name : "No file selected";
    }

    document.getElementById('uploadForm').addEventListener('submit', function (e) {
      const btn = document.getElementById('submitBtn');
      const spinner = document.getElementById('spinner');
      const fastaInput = document.getElementById('fasta_file');
      if (!fastaInput.files.length) {
        alert("Please select a FASTA file before submitting.");
        e.preventDefault();
        return false;
      }
      const fileName = fastaInput.files[0].name.toLowerCase();
      if (!(fileName.endsWith('.fasta') || fileName.endsWith('.fa'))) {
        alert("Please upload a valid FASTA file (.fasta or .fa).");
        e.preventDefault();
        return false;
      }
      btn.disabled = true;
      spinner.classList.remove('hidden');
    });
  </script>
</body>
</html>
